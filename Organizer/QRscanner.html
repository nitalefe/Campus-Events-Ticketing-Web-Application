<!--
To do:
-ui for organizer to launch qr scanner
-read qr code to database
-validate user as event organizer
-confirm ticket scan
-mark ticket as scanned
-->
<!DOCTYPE html>
<html>
<head>
  <script src="https://unpkg.com/html5-qrcode"></script>
</head>
<body>
  <div id="reader"></div>
  <div id="result"></div>

  <script>
    // Create a new instance of Html5Qrcode
  const html5QrCode = new Html5Qrcode("reader");

  // Callback when a QR code is successfully scanned
  const onScanSuccess = (decodedText, decodedResult) => {
    // Show the result
    document.getElementById("result").innerText = `Scanned: ${decodedText}`;

    // Stop the scanner after success (optional)
    html5QrCode.stop().then(() => {
      console.log("Scanner stopped");
    }).catch(err => {
      console.error("Error stopping scanner:", err);
    });
  };

  // Get the list of available cameras and start scanning
  Html5Qrcode.getCameras().then(devices => {
    if (devices && devices.length) {
      const cameraId = devices[0].id; // Use the first camera

      html5QrCode.start(
        cameraId,
        {
          fps: 10,       // frames per second
          qrbox: 250     // size of the scanning box (square)
        },
        onScanSuccess
      ).catch(err => {
        console.error("Failed to start scanner:", err);
      });
    }
  }).catch(err => {
    console.error("Camera access error:", err);
  });
  </script>
</body>
</html>
